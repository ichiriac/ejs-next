!function(o,t){"use strict";var c=function(){this.open_tag="<%",this.close_tag="%>"};c.tokens={T_EOF:0,T_INLINE:1,T_OPEN:2,T_CLOSE:3,T_OPT_COMMENT:4,T_OPT_CLEAN_OUTPUT:5,T_OPT_OUTPUT:6,T_OPT_WS_STRIP:7,T_OPT_NL_STRIP:8,T_SOURCE:9,T_OPEN_CAPTURE:10,T_CLOSE_CAPTURE:11},c.states={S_INLINE:0,S_TAG:1,S_SOURCE:2},c.prototype.input=function(t){this.source=t,this.offset=-1,this.prev_offset=this.offset,this.lastOffset=t.length-1,this.lookupOffset=t.length-2,this.state=c.states.S_INLINE,this.current=null},c.prototype.token=function(t){var e=this.prev_offset>this.lastOffset?null:this.source.substring(this.prev_offset,this.offset+1);return this.current=[t,e,this.prev_offset,this.offset+1],this.current},c.prototype.next=function(){var t;for(this.prev_offset=this.offset+1;++this.offset<this.lastOffset;){if(this.state!==c.states.S_INLINE){if(this.state===c.states.S_TAG)return t=this.source[this.offset],this.state=c.states.S_SOURCE,this.offset+=this.open_tag.length,"="==(t=this.source[this.offset])?this.token(c.tokens.T_OPT_CLEAN_OUTPUT):"-"==t?this.token(c.tokens.T_OPT_OUTPUT):"_"==t?this.token(c.tokens.T_OPT_WS_STRIP):"#"==t?this.token(c.tokens.T_OPT_COMMENT):(this.offset--,this.token(c.tokens.T_OPEN));do{if("'"==(t=this.source[this.offset])||'"'==t||"`"==t)for(;++this.offset<this.lastOffset;){var e=this.source[this.offset];if("\\"!=e){if(e==t)break}else this.offset++}if("/"==t&&"*"==this.source[this.offset+1])for(;++this.offset<this.lastOffset;)if("*"==(t=this.source[this.offset])&&"/"==this.source[this.offset+1]){++this.offset;break}if("{"==t&&"@"==this.source[this.offset+1]){if(this.prev_offset==this.offset)return this.offset++,this.token(c.tokens.T_OPEN_CAPTURE);this.offset--;break}if("@"==t&&"}"==this.source[this.offset+1]){if(this.prev_offset==this.offset)return this.offset++,this.token(c.tokens.T_CLOSE_CAPTURE);this.offset--;break}if(t==this.close_tag[0]&&this.source.substring(this.offset,this.offset+this.close_tag.length)==this.close_tag){var s="_"===this.source[this.offset-1],n="-"===this.source[this.offset-1];if((s||n)&&this.offset--,this.prev_offset==this.offset)return this.state=c.states.S_INLINE,this.offset+=this.close_tag.length,s?this.token(c.tokens.T_OPT_WS_STRIP):n?this.token(c.tokens.T_OPT_NL_STRIP):(this.offset--,this.token(c.tokens.T_CLOSE));this.offset--;break}}while(++this.offset<this.lastOffset);return this.token(c.tokens.T_SOURCE)}if(this.offset=this.source.indexOf(this.open_tag,this.offset),-1!==this.offset){if("%"===this.source[this.offset+2])continue;return this.state=c.states.S_TAG,this.offset--,this.token(c.tokens.T_INLINE)}this.offset=this.lastOffset}return this.prev_offset===this.offset?this.token(c.tokens.T_EOF):this.token(c.tokens.T_INLINE)};var _=function(t){for(var e="",s=t.next();s[0]!=c.tokens.T_EOF&&s[0]!=c.tokens.T_CLOSE&&s[0]!=c.tokens.T_OPT_WS_STRIP&&s[0]!=c.tokens.T_OPT_NL_STRIP;)e+=s[1],s=t.next();return e},T=function(t,e,s){var n="",o="\t_$e.echo = ";e.strict&&(n+='"use strict";\n'),s&&(n+='var _$f = "'+s+'";\n',n+="if (arguments.length < 2) {\n",n+="\t"+e.localsName+" = ejs;\n",n+='\tejs = (typeof global != "undefined" && global.ejs) || (typeof window != "undefined" && window.ejs);\n',n+='\tif(!ejs) return Promise.reject(new Error("EJS module is not loaded"));\n',n+="\tejs = new ejs("+JSON.stringify(e)+");\n",n+="}\n",n+=e.localsName+" = "+e.localsName+" || {};\n",n+="var include = ejs.include.bind(ejs, "+e.localsName+', "'+s+'");\n'),n+="var _$e = ejs.output();\n",s&&(n+="var layout = ejs.layout.bind(ejs, "+e.localsName+', "'+s+'", _$e);\n',n+="var block = ejs.block.bind(ejs, "+e.localsName+");\n"),e.strict||(n+="with("+e.localsName+") {\n");for(var i=t.next();;)if(i[0]==c.tokens.T_INLINE){var r=i[1];(i=t.next())[0]==c.tokens.T_OPT_WS_STRIP&&(r=r.replace(/[ \t]+$/,"")),0<r.length&&(n+=o+"`"+r.replace("`","\\`")+"`;\n")}else{if(i[0]==c.tokens.T_EOF)break;if(i[0]==c.tokens.T_CLOSE_CAPTURE)break;if(i[0]==c.tokens.T_OPT_COMMENT)n+="\t/* "+_(t)+"*/\n";else{var f=i[0]==c.tokens.T_OPEN||i[0]==c.tokens.T_OPT_WS_STRIP,h=i[0]==c.tokens.T_OPT_OUTPUT,u=i[0]==c.tokens.T_OPT_CLEAN_OUTPUT,a="";for(i=t.next();i[0]!=c.tokens.T_EOF&&i[0]!=c.tokens.T_CLOSE&&i[0]!=c.tokens.T_OPT_WS_STRIP&&i[0]!=c.tokens.T_OPT_NL_STRIP&&i[0]!=c.tokens.T_CLOSE_CAPTURE;)i[0]==c.tokens.T_OPEN_CAPTURE?(a+="{",a+=T(t,e),a+="}"):a+=i[1],i=t.next();if(i[0]==c.tokens.T_CLOSE_CAPTURE){n+=a;break}f?a+=";\n":h?a=o+a+";\n":u&&(a="\t_$e.safe = "+a+";\n"),n+=a}var l=t.current[0];(i=t.next())[0]==c.tokens.T_INLINE&&(l==c.tokens.T_OPT_WS_STRIP?i[1]=i[1].replace(/^[ \t]*\n?/,""):l==c.tokens.T_OPT_NL_STRIP&&(i[1]=i[1].replace(/^[ \t]*\n?/,"")))}return e.strict||(n+="}\n"),n+="return _$e.output;\n",s&&(n+="//@ sourceURL="+s),n},h=function(t){t||(t={}),this.options={strict:t.strict||!1,localsName:t.localsName||"locals",root:t.root||"/"}};h.prototype.compile=function(t,e){var s,n,o,i,r=(s=new c,n=t,o=this.options,i=e||"eval",s.input(n),T(s,o,i||"eval"));try{return new Function("ejs,"+this.options.localsName,r).bind(null,this)}catch(t){var f=t.lineNumber?t.lineNumber-6:1,h=new SyntaxError(t.message,e,f);throw h.stack=t.message+"\n    at "+e+":"+f+"\n"+h.stack.split(/\n/g).slice(4).join("\n"),h}},h.compile=function(t,e){return new h(e).compile(t)},h.prototype.render=function(t,e){var s=this.compile(t)(e);return"function"==typeof s.then?s:Promise.resolve(s)};var e=/[&<>'\"]/g;h.sanitize=function(t){return"string"!=typeof t&&(t=t.toString()),t.replace(e,function(t){return"&"==t?"&amp;":"<"==t?"&lt;":">"==t?"&gt;":'"'==t?"&#34;":"'"==t?"&#39;":t})},h.prototype.output=function(){var o=[],n=null,i=[],r=-1,f=!0;return new Proxy(i,{get:function(t,e){var s;return"output"==e?(s=-1==r?"":0==r?i[0]:Promise.all(i).then(function(t){for(var e=0,s=o.length;e<s;e++){var n=o[e];t[n]=h.sanitize(null==t[n]?"":t[n])}return t.join("")}),n?0<r?s.then(function(t){return n(t)}):n(s):s):"toString"==e?this.get.bind(this,t,"output"):null},set:function(t,e,s){if(null==s)return!0;if("echo"==e)"string"!=typeof s&&"function"!=typeof s.then&&(s=s.toString()),"function"==typeof s.then?(f=!0,r++,i.push(s)):f?(i.push(s),f=!1,r++):i[r]+=s;else if("safe"==e)"string"!=typeof s&&"function"!=typeof s.then&&(s=s.toString()),"function"==typeof s.then?(f=!0,r++,o.push(r),i.push(s)):f?(i.push(h.sanitize(s)),f=!1,r++):i[r]+=h.sanitize(s);else{if("hook"!=e)throw new Error("Undefined property "+e);n=s}return!0},toString:function(){return this.get(i,"output")}})},h.render=function(t,e,s){return new h(s).render(t,e)},h.prototype.include=function(t,e,s,n){return this.renderFile(this.resolveInclude(s,e),Object.assign(t,n||{}))},h.prototype.layout=function(e,s,t,n,o){var i=this;return t.hook=function(t){return o.contents=t,i.renderFile(i.resolveInclude(n,s),Object.assign({},e,o||{}))},null},h.prototype.block=function(t,e,s){return e?(t[e]||(t[e]=this.output()),3==arguments.length?(t[e].echo="function"==typeof s?s():s,s):t[e].output):null},h.prototype.resolveInclude=function(t,e,s){return e&&"eval"!=e||(e=this.options.root,s=!0),h.resolveInclude(t,e,s)},h.resolveInclude=function(t,e,s){return e&&(s||(e=path.dirname(e)),"/"==t[0]&&(t="./"+t.replace(/^\/*/,"")),t=path.resolve(e,t)),path.extname(t)||(t+=".ejs"),t},h.prototype.renderFile=function(i,r){var f=this;return new Promise(function(n,o){i.substring(0,f.options.root.length)!=f.options.root&&(i=h.resolveInclude(i,f.options.root,!0)),fs.readFile(i,function(t,e){if(t)return o(t);try{var s=f.compile(e.toString(),i)(r);s&&"function"==typeof s.then?s.then(n).catch(o):n(s)}catch(t){return o(t)}})})},h.__express=h.renderFile=function(t,e,s){return new h(s).renderFile(t,e)},"undefined"!=typeof window?window.ejs=h:"undefined"!=typeof global&&(global.ejs=h),t&&(t.ejs=h),"function"==typeof define&&define.amd&&define("ejs",h),o&&o.fn&&(o.fn.extend({ejs:function(e,t){var s=o.fn.ejs.options;t&&(s=o.extend(!0,s,t));var n=new n(s);return this.each(function(){var t=o(this).html();n.compile(t)(e).then(function(t){o(this).html(t)}.bind(this)).catch(function(t){o(this).html('<pre class="ejs-error">'+t.toString()+"</pre>")})})}}),o.fn.ejs.options={})}(jQuery,window);