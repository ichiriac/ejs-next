!function(o,t){"use strict";var a=function(){this.open_tag="<%",this.close_tag="%>",this.char_comment="#",this.char_output="=",this.char_html="-",this.char_strip="_",this.char_ignore="%"};a.tokens={T_EOF:0,T_INLINE:1,T_OPEN:2,T_CLOSE:3,T_OPT_COMMENT:4,T_OPT_CLEAN_OUTPUT:5,T_OPT_OUTPUT:6,T_OPT_WS_STRIP:7,T_OPT_NL_STRIP:8,T_CLOSE_STRIP:9,T_SOURCE:10,T_WHITESPACE:11,T_TEXT:12,T_COMMENT:13,T_IDENTIFIER:14,T_OPEN_BRACKET:15,T_CLOSE_BRACKET:16,T_OPEN_PARA:17,T_CLOSE_PARA:18,T_DBL_COLON:19,T_OPEN_CAPTURE:20,T_CLOSE_CAPTURE:21},a.states={S_INLINE:0,S_TAG:1,S_SOURCE:2},a.prototype.input=function(t){this.source=t,this.offset=-1,this.prev_offset=this.offset,this.lastOffset=t.length-1,this.lookupOffset=t.length-2,this.state=a.states.S_INLINE,this.current=null},a.prototype.token=function(t){var s=this.prev_offset>this.lastOffset?null:this.source.substring(this.prev_offset,this.offset+1);return this.current=[t,s,this.prev_offset,this.offset+1],this.current},a.prototype.next=function(){var t;for(this.prev_offset=this.offset+1;++this.offset<this.lastOffset;)if(this.state===a.states.S_INLINE){if(this.offset=this.source.indexOf(this.open_tag,this.offset),-1!==this.offset){if(this.source[this.offset+2]===this.char_ignore)continue;return this.state=a.states.S_TAG,this.offset--,this.token(a.tokens.T_INLINE)}this.offset=this.lastOffset}else{if(this.state!==a.states.S_TAG){if(" "==(t=this.source[this.offset])||"\n"==t||"\t"==t||"\r"==t){for(;++this.offset<this.lastOffset;)if(" "!=(t=this.source[this.offset])&&"\n"!=t&&"\t"!=t&&"\r"!=t){this.offset--;break}return this.token(a.tokens.T_WHITESPACE)}if("'"==t||'"'==t||"`"==t){for(;++this.offset<this.lastOffset;){var s=this.source[this.offset];if("\\"!=s){if(s==t)break}else this.offset++}return this.token(a.tokens.T_TEXT)}if("/"==t&&"*"==this.source[this.offset+1]){for(;++this.offset<this.lastOffset;)if("*"==(t=this.source[this.offset])&&"/"==this.source[this.offset+1]){++this.offset;break}return this.token(a.tokens.T_COMMENT)}if("a"<=t&&t<="z"||"A"<=t&&t<="Z"||"_"==t||"$"==t){for(;++this.offset<this.lastOffset;)if(!("a"<=(t=this.source[this.offset])&&t<="z"||"A"<=t&&t<="Z"||"0"<=t&&t<="9"||"_"==t||"$"==t||"."==t)){this.offset--;break}if("_"!=this.source[this.offset]||this.prev_offset<this.offset)return this.token(a.tokens.T_IDENTIFIER)}if("("==t)return this.token(a.tokens.T_OPEN_PARA);if(")"==t)return this.token(a.tokens.T_CLOSE_PARA);if("{"==t)return"@"==this.source[this.offset+1]?(this.offset++,this.token(a.tokens.T_OPEN_CAPTURE)):this.token(a.tokens.T_OPEN_BRACKET);if("@"==t&&"}"==this.source[this.offset+1])return this.offset++,this.token(a.tokens.T_CLOSE_CAPTURE);if("}"==t)return this.token(a.tokens.T_CLOSE_BRACKET);if(":"==t)return this.token(a.tokens.T_DBL_COLON);if(","==t)return this.token(a.tokens.T_SOURCE);if(";"==t)return this.token(a.tokens.T_SOURCE);if("="==t)return this.token(a.tokens.T_SOURCE);do{if((t=this.source[this.offset])==this.close_tag[0]&&this.source.substring(this.offset,this.offset+this.close_tag.length)==this.close_tag){var e=this.source[this.offset-1]==this.char_strip,i=this.source[this.offset-1]==this.char_html;return(e||i)&&this.offset--,this.prev_offset==this.offset?(this.state=a.states.S_INLINE,this.offset+=this.close_tag.length,e?this.token(a.tokens.T_CLOSE_STRIP):i?this.token(a.tokens.T_OPT_NL_STRIP):(this.offset--,this.token(a.tokens.T_CLOSE))):(this.offset--,this.token(a.tokens.T_SOURCE))}if(t!=this.char_strip&&t!=this.char_html||this.source[this.offset+1]!=this.close_tag[0]){if(" "==t||"\t"==t||"\r"==t||"\n"==t)break;if("a"<=t&&t<="z")break;if("A"<=t&&t<="Z")break;if("_"==t||"$"==t)break;if("("==t||")"==t)break;if('"'==t||"'"==t||"`"==t)break;if("{"==t||"}"==t||":"==t||"@"==t||"="==t||";"==t||","==t)break}}while(++this.offset<this.lastOffset);return this.offset--,this.token(a.tokens.T_SOURCE)}if((t=this.source[this.offset])!==this.open_tag[0])return this.state=a.states.S_INLINE,t==this.char_strip?(this.offset+=this.close_tag.length,this.token(a.tokens.T_CLOSE_STRIP)):t==this.char_html?(this.offset+=this.close_tag.length,this.token(a.tokens.T_OPT_NL_STRIP)):(this.offset+=this.close_tag.length-1,this.token(a.tokens.T_CLOSE));switch(this.state=a.states.S_SOURCE,this.offset+=this.open_tag.length,t=this.source[this.offset]){case this.char_comment:return this.state=a.states.S_INLINE,this.offset=this.source.indexOf(this.close_tag,this.offset),-1==this.offset?this.offset=this.lastOffset:this.offset+=this.close_tag.length-1,this.token(a.tokens.T_OPT_COMMENT);case this.char_output:return this.token(a.tokens.T_OPT_CLEAN_OUTPUT);case this.char_html:return this.token(a.tokens.T_OPT_OUTPUT);case this.char_strip:return this.token(a.tokens.T_OPT_WS_STRIP);default:return this.offset--,this.token(a.tokens.T_OPEN)}}return this.prev_offset===this.offset?this.token(a.tokens.T_EOF):this.token(a.tokens.T_INLINE)};var e={abstract:!0,else:!0,instanceof:!0,super:!0,boolean:!0,enum:!0,int:!0,switch:!0,break:!0,export:!0,interface:!0,synchronized:!0,byte:!0,extends:!0,let:!0,this:!0,case:!0,false:!0,long:!0,throw:!0,catch:!0,final:!0,native:!0,throws:!0,char:!0,finally:!0,new:!0,transient:!0,class:!0,float:!0,null:!0,true:!0,const:!0,for:!0,package:!0,try:!0,continue:!0,function:!0,private:!0,typeof:!0,debugger:!0,goto:!0,protected:!0,var:!0,default:!0,if:!0,public:!0,void:!0,delete:!0,implements:!0,return:!0,volatile:!0,do:!0,import:!0,short:!0,while:!0,double:!0,in:!0,static:!0,with:!0,layout:!0,include:!0,block:!0,Math:!0,Array:!0,Object:!0,String:!0,Function:!0,Date:!0,require:!0,window:!0,document:!0,$:!0,module:!0},u=function(t,s,e){this.code="",this.source="",this.source_offset=0,this.lexer=t,this.locals=[{}],this.mappings=[],this.filename=e,this.names=[],this.useInclude=!1,this.useLayout=!1,this.useBlock=!1,this.opts=s||{},this.opts.localsName||(this.opts.localsName="locals"),this.opts.strict&&this.write('"use strict";\n'),this.write("if (arguments.length < 2) {\n"),this.write("\t"+this.opts.localsName+" = ejs;\n"),this.write('\tejs = (typeof global != "undefined" && global.ejs) || (typeof window != "undefined" && window.ejs);\n'),this.write('\tif(!ejs) return Promise.reject(new Error("EJS module is not loaded"));\n'),this.write("\tejs = new ejs("+JSON.stringify(this.opts)+");\n"),this.write("}\n"),this.write(this.opts.localsName+" = "+this.opts.localsName+" || {};\n"),this.write("var include = ejs.include.bind(ejs, "+this.opts.localsName+', "'+e+'");\n'),this.write("var block = ejs.block.bind(ejs, "+this.opts.localsName+");\n"),this.write("var _$e = ejs.output();\n"),this.write("var layout = ejs.layout.bind(ejs, "+this.opts.localsName+', "'+e+'", _$e);\n'),this.setLocalVar(this.opts.localsName),this.next().parseBody(),this.write("\nreturn _$e.toString();\n")};u.prototype.sourcemap=function(){var t={version:3,sources:[this.filename],names:this.names,mappings:";;;;;;;;;;;;AAAA",file:this.filename,sourcesContent:this.source};return"//# sourceMappingURL=data:application/json;charset=utf-8;base64,"+new Buffer(JSON.stringify(t)).toString("base64")},u.prototype.next=function(){return this.tok=this.lexer.next(),this.source+=this.tok[1],"{"==this.tok[1]&&(this.inObject=!0),"}"==this.tok[1]&&(this.inObject=!1),":"==this.tok[1]?this.inKey=!0:this.inKey=!1,this},u.prototype.nextTok=function(){for(this.next();(this.tok[0]==a.tokens.T_WHITESPACE||this.tok[0]==a.tokens.T_COMMENT)&&(this.write().next(),this.tok[0]!=a.tokens.T_EOF););return this},u.prototype.write=function(t){return t||(t=this.tok[1]),this.source_offset!=this.source.length&&(this.mappings.push([this.source_offset,this.code.length]),this.source_offset=this.source.length),this.code+=t,this},u.prototype.toString=function(){return this.opts.debug?this.code+"\n"+this.sourcemap():this.code},u.prototype.isReserved=function(t){if(t=t.split(".",2)[0],e[t])return!0;for(var s=this.locals.length-1;-1<s;s--)if(this.locals[s][t])return!0;return!1},u.prototype.setLocalVar=function(t){return t||(t=this.tok[1]),this.locals[this.locals.length-1][t]=!0,this},u.prototype.parseValue=function(t){for(;this.tok[0]!=a.tokens.T_EOF;){if(this.tok[1]==t)return this;if("("==this.tok[1]&&this.write().nextTok().parseValue(")"),"{"==this.tok[1]&&this.write().nextTok().parseValue("}"),"["==this.tok[1]&&this.write().nextTok().parseValue("]"),"function"==this.tok[1]&&this.write().nextTok().parseFunction(),!t&&(";"==this.tok[1]||","==this.tok[1]))return this;this.write().nextTok()}return this},u.prototype.parseVar=function(){if(this.tok[0]==a.tokens.T_IDENTIFIER&&this.setLocalVar().write().nextTok(),"="==this.tok[1]&&this.write().nextTok().parseValue(),","==this.tok[1]&&this.write().nextTok().parseVar(),";"==this.tok[1])return this.write().nextTok()},u.prototype.parseFunction=function(t){for(this.tok[0]==a.tokens.T_IDENTIFIER&&this.setLocalVar().write().nextTok(),this.locals.push({}),this.tok[0]==a.tokens.T_OPEN_PARA&&this.write()&&this.nextTok(),this.tok[0]==a.tokens.T_IDENTIFIER&&this.setLocalVar().write().nextTok();","==this.tok[1]&&(this.write().nextTok(),this.tok[0]!=a.tokens.T_CLOSE_PARA);)this.setLocalVar().write().nextTok();this.tok[0]==a.tokens.T_CLOSE_PARA&&this.write().nextTok(),this.tok[0]==a.tokens.T_OPEN_CAPTURE?(this.write("{\nvar _$e = ejs.output();\n"),this.nextTok().parseBody(a.tokens.T_CLOSE_CAPTURE),this.write("\nreturn _$e.toString();\n}"+(t?")":"")),this.tok[0]==a.tokens.T_CLOSE_CAPTURE&&this.nextTok()):(this.tok[0]==a.tokens.OPEN_BRACKET&&this.write().nextTok(),this.parseBody(a.tokens.CLOSE_BRACKET),this.tok[0]==a.tokens.CLOSE_BRACKET&&this.write().nextTok()),this.locals.pop()},u.prototype.parseBody=function(t){for(;;)if(this.tok[0]==a.tokens.T_INLINE){var s=this.tok[1];this.next().tok[0]==a.tokens.T_OPT_WS_STRIP&&(s=s.replace(/[ \t]+$/,"")),0<s.length&&this.write("_$e.write(`"+s.replace("`","\\`")+"`);\n")}else{if(this.tok[0]==a.tokens.T_EOF||this.tok[0]==t)break;if(this.tok[0]==a.tokens.T_OPT_COMMENT)this.write("/* "+this.tok[1].replace("/","?")+" */\n").next();else{var e=!1;for(this.tok[0]==a.tokens.T_OPT_OUTPUT?(this.write("_$e.write("),e=!0,this.nextTok()):this.tok[0]==a.tokens.T_OPT_CLEAN_OUTPUT?(this.write("_$e.safe_write("),e=!0,this.nextTok()):this.tok[0]!=a.tokens.T_OPEN&&this.tok[0]!=a.tokens.T_OPT_WS_STRIP||(e=!1,this.nextTok());this.tok[0]!=a.tokens.T_EOF&&this.tok[0]!=a.tokens.T_CLOSE&&this.tok[0]!=a.tokens.T_CLOSE_STRIP&&this.tok[0]!=a.tokens.T_OPT_NL_STRIP;){if(this.tok[0]==t)return this;if(this.tok[0]==a.tokens.T_IDENTIFIER){if("function"!=this.tok[1]){if("var"==this.tok[1]||"let"==this.tok[1]||"const"==this.tok[1]){this.write("var").nextTok().parseVar();continue}var i=this.tok[1];if(this.nextTok(),this.inObject&&this.inKey)this.write(i);else if(this.isReserved(i))this.write(i);else if(this.opts.strict)this.write(this.opts.localsName+"."+i);else{i=i.split(".");for(var o=this.opts.localsName,n=0;n<i.length;n++)o="("+o+"."+i[n]+' || "")';this.write(o)}continue}this.write().nextTok().parseFunction(e)}else this.write();this.nextTok()}e?this.write(");\n"):this.write(";");var h=this.tok[0];this.next().tok[0]==a.tokens.T_INLINE&&(h==a.tokens.T_CLOSE_STRIP?this.tok[1]=this.tok[1].replace(/^[ \t]*\n?/,""):h==a.tokens.T_OPT_NL_STRIP&&(this.tok[1]=this.tok[1].replace(/^[ \t]*\n?/,"")))}}return this};var n=function(){this.hook=null,this.output=[],this.offset=-1,this.sanitize=[],this.isPromise=!0},s=/[&<>'\"]/g;n.sanitize=function(t){return"string"!=typeof t&&(t=t.toString()),t.replace(s,function(t){return"&"==t?"&amp;":"<"==t?"&lt;":">"==t?"&gt;":'"'==t?"&#34;":"'"==t?"&#39;":t})},n.prototype.write=function(t){if(null!=t){var s="string"==typeof t;s||"function"==typeof t.then||(t=t.toString(),s=!0),s?this.isPromise?(this.output.push(t),this.isPromise=!1,this.offset++):this.output[this.offset]+=t:(this.isPromise=!0,this.offset++,this.output.push(t))}},n.prototype.safe_write=function(t){if(null!=t){var s="string"==typeof t;s||"function"==typeof t.then||(t=t.toString(),s=!0),s?this.isPromise?(this.output.push(n.sanitize(t)),this.isPromise=!1,this.offset++):this.output[this.offset]+=n.sanitize(t):(this.isPromise=!0,this.offset++,this.sanitize.push(this.offset),this.output.push(t))}},n.prototype.toString=function(){var t;if(t=-1==this.offset?"":0==this.offset?this.output[0]:Promise.all(this.output).then(function(t){for(var s=0,e=this.sanitize.length;s<e;s++){var i=this.sanitize[s];t[i]=n.sanitize(null==t[i]?"":t[i])}return t.join("")}.bind(this)),this.hook){if(t.then)return t.then(function(t){return this.hook(t)}.bind(this));t=this.hook(t)}return t};var f=function(t){t||(t={}),this.options={strict:t.strict||!1,localsName:t.localsName||"locals",root:t.root||"/"}};f.prototype.compile=function(t,s){var e,i,o,n,h=(e=new a,i=t,o=this.options,n=s||"eval",e.input(i),new u(e,o,n||"eval").toString());try{return new Function("ejs,"+this.options.localsName,h).bind(null,this)}catch(t){var r=t.lineNumber?t.lineNumber-6:1,f=new SyntaxError(t.message,s,r);throw f.stack=t.message+"\n    at "+s+":"+r+"\n"+f.stack.split(/\n/g).slice(4).join("\n"),f}},f.compile=function(t,s){return new f(s).compile(t)},f.prototype.render=function(t,s){var e=this.compile(t)(s);return"function"==typeof e.then?e:Promise.resolve(e)},f.prototype.output=function(){return new n},f.render=function(t,s,e){return new f(e).render(t,s)},f.prototype.include=function(t,s,e,i){return this.renderFile(this.resolveInclude(e,s),Object.assign(t,i||{}))},f.prototype.layout=function(s,e,t,i,o){var n=this;return t.hook=function(t){return(o=Object.assign({},s,o||{})).contents=t,n.renderFile(n.resolveInclude(i,e),o)},null},f.prototype.block=function(t,s,e){return s?(t[s]||(t[s]=this.output()),3==arguments.length?(t[s].echo="function"==typeof e?e():e,e):t[s].output):null},f.prototype.resolveInclude=function(t,s,e){return s&&"eval"!=s||(s=this.options.root,e=!0),"/"==t[0]&&(t="./"+t.replace(/^\/*/,""),s=this.options.root,e=!0),f.resolveInclude(t,s,e)},f.resolveInclude=function(t,s,e){return s&&(e||(s=path.dirname(s)),t=path.resolve(s,t)),path.extname(t)||(t+=".ejs"),t},f.prototype.renderFile=function(n,h){var r=this;return new Promise(function(i,o){n.substring(0,r.options.root.length)!=r.options.root&&(n=f.resolveInclude(n,r.options.root,!0)),fs.readFile(n,function(t,s){if(t)return o(t);try{var e=r.compile(s.toString(),n)(h);e&&"function"==typeof e.then?e.then(i).catch(o):i(e)}catch(t){return o(t)}})})},f.__express=f.renderFile=function(t,s,e){return new f(e).renderFile(t,s)},"undefined"!=typeof window?window.ejs=f:"undefined"!=typeof global&&(global.ejs=f),t&&(t.ejs=f),"function"==typeof define&&define.amd&&define("ejs",f),o&&o.fn&&(o.fn.extend({ejs:function(s,t){var e=o.fn.ejs.options;t&&(e=o.extend(!0,e,t));var i=new i(e);return this.each(function(){var t=o(this).html();i.compile(t)(s).then(function(t){o(this).html(t)}.bind(this)).catch(function(t){o(this).html('<pre class="ejs-error">'+t.toString()+"</pre>")})})}}),o.fn.ejs.options={})}(jQuery,window);