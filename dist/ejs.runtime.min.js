!function(t,e){"use strict";var n=function(){this.hook=null,this.output=[],this.offset=-1,this.sanitize=[],this.isPromise=!0},i=/[&<>'\"]/g;n.sanitize=function(t){return"string"!=typeof t&&(t=t.toString()),t.replace(i,function(t){return"&"==t?"&amp;":"<"==t?"&lt;":">"==t?"&gt;":'"'==t?"&#34;":"'"==t?"&#39;":t})},n.prototype.buffer=function(t){var e=this.hook,n=this.output,i=this.offset,o=this.sanitize,s=this.isPromise;return this.hook=null,this.output=[],this.offset=-1,this.sanitize=[],this.isPromise=!0,function(){var t=this.toString();return this.hook=e,this.output=n,this.offset=i,this.sanitize=o,this.isPromise=s,t}.bind(this)},n.prototype.write=function(t){if(null!=t){var e="string"==typeof t;e||"function"==typeof t.then||(t=t.toString(),e=!0),e?this.isPromise?(this.output.push(t),this.isPromise=!1,this.offset++):this.output[this.offset]+=t:(this.isPromise=!0,this.offset++,this.output.push(t))}},n.prototype.safe_write=function(t){if(null!=t){var e="string"==typeof t;e||"function"==typeof t.then||(t=t.toString(),e=!0),e?this.isPromise?(this.output.push(n.sanitize(t)),this.isPromise=!1,this.offset++):this.output[this.offset]+=n.sanitize(t):(this.isPromise=!0,this.offset++,this.sanitize.push(this.offset),this.output.push(t))}},n.prototype.toString=function(){var t;if(t=-1==this.offset?"":0==this.offset?this.output[0]:Promise.all(this.output).then(function(t){for(var e=0,i=this.sanitize.length;e<i;e++){var o=this.sanitize[e];t[o]=n.sanitize(null==t[o]?"":t[o])}return t.join("")}.bind(this)),this.hook){if(t.then)return t.then(function(t){return this.hook(t)}.bind(this));t=this.hook(t)}return t};var o=function(t){t||(t={}),this.options={cache:t.hasOwnProperty("cache")?t.cache:o.cache,strict:t.hasOwnProperty("strict")?t.strict:o.strict,profile:t.hasOwnProperty("profile")?t.profile:o.profile,localsName:t.localsName||"locals",delimiter:t.delimiter||o.delimiter,root:t.root||o.root},this._session={}};o.dirname="views",o.root="/",o.cache=!1,o.strict=!1,o.profile=!1,o.sourcemap=!1,o.delimiter="%",o.__cache={},o.__fn={},o.prototype.compile=function(t,e){if(this.options.cache&&o.__cache.hasOwnProperty(t))return o.__cache[t];var n=new lexer(this.options.delimiter);n.input(t);var i=new transpile(n,this.options,e||"eval").toString();try{var s=new(0,async function(){}.constructor)("ejs",this.options.localsName,i).bind(null,this);return this.options.cache&&(o.__cache[t]=s),s}catch(t){var r=t.lineNumber?t.lineNumber-6:1,c=new SyntaxError(t.message,e,r);throw console.log("Bad code : "+i),c.stack=t.message+"\n    at "+e+":"+r+"\n"+c.stack.split(/\n/g).slice(4).join("\n"),c}},o.compile=function(t,e){return new o(e).compile(t)},o.prototype.prepareContext=function(t){return t},o.prototype.render=function(t,e){var n=this.compile(t)(this.prepareContext(e));return"function"==typeof n.then?n:Promise.resolve(n)},o.prototype.output=function(){return new n},o.render=function(t,e,n){return new o(n).render(t,e)},o.prototype.include=function(t,e,n,i){return"function"==typeof i&&(i={contents:i()}),"string"==typeof i&&(i={contents:i}),this.renderFile(this.resolveInclude(n,e),Object.assign({},t,i||{}))},o.prototype.layout=function(t,e,n,i,o){var s=this;return n.hook=function(n){return(o=Object.assign({},t,o||{})).contents=n,s.renderFile(s.resolveInclude(i,e),o)},null},o.prototype.block=function(t,e,n){if(!e)return null;if(this._session[e]||(this._session[e]=this.output()),3==arguments.length){if("function"==typeof n){var i=this._output.buffer();n(),n=i()}return this._session[e].write(n),this._session[e]}return this._session[e].toString()},o.prototype.resolveInclude=function(t,e,n){return e&&"eval"!=e||(e=Array.isArray(this.options.root)?this.options.root[0]:this.options.root,n=!0),"/"!=t[0]||path.isAbsolute(t)||(t="./"+t.replace(/^\/*/,""),e=Array.isArray(this.options.root)?this.options.root[0]:this.options.root,n=!0),o.resolveInclude(t,e,n,this.options.root)},o.resolveInclude=function(t,e,n,i){if(e&&(n||(e=path.dirname(e)),t=path.resolve(e,t)),path.extname(t)||(t+=".ejs"),!i||!Array.isArray(i))return t;try{return o.selectFirstPathMatch(t,i)}catch(t){throw t}},o.registerFunction=function(t,e){o.__fn[t]=e,transpile.__fn[t]=!0},o.selectFirstPathMatch=function(t,e){try{const{root:n,siblings:i}=o.relativeSiblings(t,e);t=path.relative(n,t);for(let e of i){const i=path.join(n,e,t);if(fs.existsSync(i))return i}return path.join(n,t)}catch(t){throw t}},o.relativeSiblings=function(t,e){try{const n=o.selectRoot(t,e);if(!n)throw new Error(`File : ${t} doesn't exists`);const i=[];for(let t of e)i.push(path.relative(n,t));return{siblings:i,root:n}}catch(t){throw t}},o.selectRoot=function(t,e){for(let n of e){if(n==t.substring(0,n.length))return n}return!1},o.prototype.renderFile=function(t,e){const n=this,i=new Promise(function(s,r){try{t=n.resolveInclude(t)}catch(t){return r(t)}var c=function(i){const o=function(n,o){const s=n.stack.split("\n");let r=s,c="unknown";if(s[1]&&s[1].split&&"function"==typeof s[1].split&&(c=(r=s[1].split(":"))[0].trim().split(" ")[1]),"eval"==c){r=r[r.length-2]-18,isNaN(r)&&(r=1);const e=r>5?r-5:0,n=function(t,n){t.length>123&&(t=t.substring(0,80)+"..."+t.substring(t.length-40));let i=e+n+1;return i==r?(""+i).padStart(3,"0")+" | "+t+"\n     "+"".padEnd(t.length,"~"):(""+i).padStart(3,"0")+" | "+t};if(o){const t=(o=o.toString()).toString().split("\n").slice(e>18?e-18:e,r+18);console.error(t.map(n).join("\n"))}const c=i.toString().split("\n").slice(e,r+5);console.error(c.map(n).join("\n")),console.error("\n"+s[0]+"\n at "+t+":"+r)}else console.error(n);e._includes&&(e._includes.pop(),e._includes.length>0&&console.error("\nIncludes stack : \n- "+e._includes.join("\n- ")))};var c;try{e._includes||(e._includes=[]),e._includes.push(t);var h=(c=n.compile(i.toString(),t))(n.prepareContext(e));h&&"function"==typeof h.then?h.then(function(t){e._includes.pop(),s(t)}).catch(n.strict?r:function(t){o(t,c),s("\x3c!-- "+t.message+" --\x3e")}):(e._includes.pop(),s(h))}catch(t){if(n.strict)return r(t);o(t,c),s("\x3c!-- "+t.message+" --\x3e")}};if(n.options.profile){const e=(new Date).getTime();nextTick(function(){i.then(function(n){let i=(new Date).getTime()-e;i<1e3?i+="ms":i=Math.round(i/100)/10+"sec";let o=n?n.length:0;return o<2048?o+="B":o=Math.round(o/1024)+"kB",console.log("Rendering "+o+" in "+i+" for "+t),n})})}n.options.cache&&o.__cache.hasOwnProperty(t)?c(o.__cache[t]):fs.readFile(t,function(e,i){if(e)return r(e);n.options.cache&&(o.__cache[t]=i),c(i)})});return i},o.renderFile=function(t,e,n){return new o(n).renderFile(t,e)},o.__express=async function(t,e,n){if(!n||"function"!=typeof n)throw new Error("No response callback");var i={};e.settings&&(e.settings["view cache"]&&(i.cache=!0),e.settings.views&&(i.root=e.settings.views));try{const s=await o.renderFile(t,e,i);"string"==typeof s?n(null,s):n(s,null)}catch(t){n(t,null)}},"undefined"!=typeof window?window.ejs=o:"undefined"!=typeof global&&(global.ejs=o),e&&(e.ejs=o),"function"==typeof define&&define.amd&&define("ejs",o),t&&t.fn&&(t.fn.extend({ejs:function(e,n){var i=t.fn.ejs.options;n&&(i=t.extend(!0,i,n));var o=new o(i);return this.each(function(){var n=t(this).html();o.compile(n)(e).then(function(e){t(this).html(e)}.bind(this)).catch(function(e){t(this).html('<pre class="ejs-error">'+e.toString()+"</pre>")})})}}),t.fn.ejs.options={})}(jQuery,window);