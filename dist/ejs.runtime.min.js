!function(i,t){"use strict";var o=function(t,e){this._buffer="",this._parts=[],this._filename=e,this._engine=t||new u};o.prototype.push=function(t){var e=new o(this._engine,this._filename);for(var n in Object.assign(e,t),this)"_"!==n[0]&&this.hasOwnProperty(n)&&void 0===typeof t[n]&&(e[n]=this[n]);return e},o.prototype.echo=function(t){return"function"==typeof t.then?(0<this._buffer.length&&this._parts.push(this._buffer),this._parts.push(t),this._buffer=""):this._buffer+=t,this};var e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"};o.prototype.safeEcho=function(t){if("function"==typeof t.then)return this.echo(Promise.resolve(t).then(function(t){return null===t?null:t.replace(/[&<>'"]/g,function(t){return e[t]})}));"string"==typeof t?this.echo(t.replace(/[&<>'"]/g,function(t){return e[t]})):this.echo(new String(t).replace(/[&<>'"]/g,function(t){return e[t]}))},o.prototype.include=function(t,e){return"/"!==t[0]&&(t=path.relative(this._engine.options.root,this._engine.resolveInclude(t,this._filename,!1))),this._engine.renderFile(t,this.push(e))},o.prototype.block=function(t,e){if(this.blocks||(this.blocks={}),this.blocks[t]||(this.blocks[t]=[]),e&&"function"==typeof e){var n=e({});return this.blocks[t].push(n),n}return this.blocks[t]},o.prototype.resolveOutput=function(){return 0===this._parts.length?Promise.resolve(this._buffer):(0<this._buffer.length&&(this._parts.push(this._buffer),this._buffer=""),Promise.all(this._parts).then(function(t){return this._buffer=t.join(""),this._parts=[],this._buffer}.bind(this)))};var n={locals:!0,Math:!0,Date:!0,global:!0,window:!0,Function:!0};for(var r in global||window)n[r]=!0;var s={get:function(t,e){return e===Symbol.unscopables?n:(void 0===t[e]&&(t[e]=new Proxy({},s)),t[e])},set:function(t,e,n){t[e]=n},has:function(t,e){return!n.hasOwnProperty(e)}};context=function(t,e,n){if(t instanceof Proxy)return t;var r;if(r=t instanceof o?t:Object.assign(new o(e,n),t),e.options.strict||"function"!=typeof Proxy)return r;for(var i in r)"function"==typeof r[i]&&(r[i]=r[i].bind(r));return new Proxy(r,s)};var u=function(t){t||(t={}),this.options={strict:t.strict||!1,localsName:t.localsName||"locals",root:t.root||"/"}};u.prototype.compile=function(t,e){e||(e="eval");var n=transpile(new lexer,t,this.options,e);try{return new Function("ejs,"+this.options.localsName,n).bind(null,u)}catch(t){var r=t.lineNumber?t.lineNumber-6:1,i=new SyntaxError(t.message,e,r);throw i.stack=t.message+"\n    at "+e+":"+r+"\n"+i.stack.split(/\n/g).slice(4).join("\n"),i}},u.compile=function(t,e){return new u(e).compile(t)},u.prototype.render=function(t,e){return this.compile(t)(context(e||{},this))},u.render=function(t,e,n){return new u(n).render(t,e)},u.prototype.resolveInclude=function(t,e,n){return e||(e=this.options.root,n=!0),u.resolveInclude(t,e,n)},u.resolveInclude=function(t,e,n){return e&&(n||(e=path.dirname(e)),t=path.resolve(e,t)),path.extname(t)||(t+=".ejs"),t},u.prototype.renderFile=function(i,o){var s=this;return new Promise(function(n,r){i=u.resolveInclude(i,s.options.root,!0),fs.readFile(i,function(t,e){if(t)return r(t);try{s.compile(e.toString(),i)(context(o||{},s,i)).then(n).catch(r)}catch(t){return r(t)}})})},u.context=function(t,e,n){return t instanceof o?t:context(t,new u(e),n)},u.renderFile=function(t,e,n){return new u(n).renderFile(t,e)},u.__express=u.renderFile,"undefined"!=typeof window?window.ejs=u:"undefined"!=typeof global&&(global.ejs=u),t&&(t.ejs=u),"function"==typeof define&&define.amd&&define("ejs",u),i&&i.fn&&(i.fn.extend({ejs:function(e,t){var n=i.fn.ejs.options;t&&(n=i.extend(!0,n,t));var r=new r(n);return this.each(function(){var t=i(this).html();r.compile(t)(e).then(function(t){i(this).html(t)}.bind(this)).catch(function(t){i(this).html('<pre class="ejs-error">'+t.toString()+"</pre>")})})}}),i.fn.ejs.options={})}(jQuery,window);